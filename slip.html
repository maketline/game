<!DOCTYPE html>
<html langlang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/ad42651166.js" crossorigin="anonymous"></script>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous" />
  <title>ร่วมกิจกรรมทายหวยกับ CDOLIN</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
	    <link href='https://fonts.googleapis.com/css?family=Prompt' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link href="https://ltschool.web.app/css/Bootstrapcolor.css" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sarabun" />
	

	<style>
		body {
			font-family: "Sarabun", sans-serif;
		}
	</style>

<body>
<!--   เริ่มฟอร์ม   -->
    <div class="container">
		<div class="col-lg-6 col-md-8 mx-auto mt-2">
			<nav class="navbar navbar-expand-lg navbar-dark bd-indigo-500">
				<div class="container">
					<h6 class="Sarabun text-white"><i class="fas fa-address-book"></i>ส่งผลทายหวยเลขท้าย2ตัว
          งวด<script language="javascript">
now = new Date();
var thday = new Array ("อาทิตย์","จันทร์",
"อังคาร","พุธ","พฤหัส","ศุกร์","เสาร์");
var thmonth = new Array ("มกราคม","กุมภาพันธ์","มีนาคม",
"เมษายน","พฤษภาคม","มิถุนายน", "กรกฎาคม","สิงหาคม","กันยายน",
"ตุลาคม","พฤศจิกายน","ธันวาคม");

document.write("วัน" + thday[now.getDay()]+ "ที่ "+ now.getDate()+ " " +
thmonth[now.getMonth()]+ " " + (0+now.getYear()+ 2443));
</script></p></h6>
				</div>
			</nav>
     <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <!-- <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
     <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
     <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4" aria-label="Slide 5"></button> -->
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="https://promotions.co.th/wp-content/uploads/2020/02/Uf.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption  d-md-block">
        <h5 class="badge bg-primary text-wrap" style="width: 6rem;" >ส่งผลทายหวยเลขท้าย2ตัว</h5>
      </div>
    </div>
    <!-- <div class="carousel-item">
      <img src="https://maketline.github.io/game/imgs/2.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption  d-md-block">
        <h5 class="badge bg-primary text-wrap" style="width: 6rem;" >ธนบัตรใบที่2</h5>
      </div>
    </div>
    <div class="carousel-item">
      <img src="https://maketline.github.io/game/imgs/3.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption  d-md-block">
        <h5 class="badge bg-primary text-wrap" style="width: 6rem;" >ธนบัตรใบที่3</h5>
      </div>
    </div>
     <div class="carousel-item">
      <img src="https://maketline.github.io/game/imgs/4.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption  d-md-block">
        <h5 class="badge bg-primary text-wrap" style="width: 6rem;" >ธนบัตรใบที่4</h5>
      </div>
    </div>
     <div class="carousel-item">
      <img src="https://maketline.github.io/game/imgs/5.jpg" class="d-block w-100" alt="...">
      <div class="carousel-caption  d-md-block">
        <h5 class="badge bg-primary text-wrap" style="width: 6rem;" >ธนบัตรใบที่5</h5>
      </div>
    </div> -->
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
		</div>

	<div class="container">
		<div class="row">
			<div class="col">
				<form id="registform">
					<br>
					<div class="col-lg-6 col-md-12 mx-auto">
						<div class="form-row">
							<div class="form-group col-md-12 center">
							<div class="form-row">
                <div class="form-group col-md-6">
      <label for="number1">ชื่อของท่าน</label>
      <input type="text" class="form-control" placeholder="ระบุชื่อของท่าน" id="name"  name="name"required>
    </div>
     <div class="form-group col-md-6">
      <label for="number1">เบอร์โทรติดต่อ</label>
      <input type="tel" class="form-control" pattern="[0-9]{10}" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="ระบุเบอร์โทรติดต่อกลับ" id="tel" name="tel" maxlength="10"  required>
    </div>
       <div class="form-group col-md-6">
      <label for="number1">บอกชื่อสินค้าของร้านเรามา1อย่าง</label>
      <input type="text" class="form-control"  placeholder="ระบุชื่อสินค้าร้านร้านที่ท่านรู้จัก" id="productname" name="productname"   required>
    </div>
    
    <div class="form-group col-md-2">
      <label for="number1">เลขที่1</label>
      <input type="tel" class="form-control" pattern="[0-9]{2}"oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="เลขที่1" id="number1" name="number1" maxlength="2"  required>
    </div>
      <div class="form-group col-md-2">
      <label for="number2">เลขที่2</label>
      <input type="tel" class="form-control" pattern="[0-9]{2}" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="เลขที่2" id="number2" name="number2" maxlength="2" required>
    </div>
      <div class="form-group col-md-2">
      <label for="number3">เลขที่3</label>
      <input type="tel" class="form-control" pattern="[0-9]{2}" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="เลขที่3" id="number3" name="number3" maxlength="2" required>
    </div>
    <div class="form-group col-md-2">
      <label for="number4">เลขที่4</label>
      <input type="tel" class="form-control" pattern="[0-9]{2}" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="เลขที่4" id="number4" name="number4" maxlength="2" required>
    </div>
    <div class="form-group col-md-2">
      <label for="number5">เลขที่5</label>
      <input type="tel" class="form-control" pattern="[0-9]{2}" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');" placeholder="เลขที่5" id="number5" name="number5" maxlength="2"  required>
    </div>
  </div>
   <div class="row justify-content-center">
                <div class="col-md-3 mt-3">
                    <div class="col-md mt-2 text-center">
                        <img id="img-upload" width="150px" />
                    </div>
                    <label class="form-label">แนบรูปสินค้าที่ท่านชอบ</label>
                    <input type="file" name="img_bill" accept="image/*" class="form-control" id="img_bill" required />
                </div>
            </div>
								<div class="row"> </div>
								<div class="col"> </div>
								 <div class="row justify-content-center">
                <div class="col-md-3 mt-4 text-center">
                    <button class="btn btn-outline-success btn-lg" type="submit" id="btn_submit">
                        บันทึกข้อมูล
                    </button>
                </div>
              <div class="justify-content-center">
<!--             <p id="aleart" class="justify-content-center" style display: none;>
              **อย่าปิดหน้านี้ จนกว่าจะบันทึกสำเร็จ**
              </p> -->
          </div>
            </div>
        </form>
			</div>
		</div>
	</div>
    
    
  <!--   จบฟอร์ม   -->
  
    
    <script>
     // สร้าง liff ใน line OA ก่อน 
        let liffId = "1657132355-1mkXOomV"; // เปลี่ยน liffid
        var scriptURL =
            "https://script.google.com/macros/s/AKfycbyHYadZ4hY1dkPRUag4aBdaw2H9DqCse9eDObxQXOLT-__9rday1nUlrKZReA8lDJoG/exec"; // เปลี่ยน script
    // คำสั่งของของระบบ line   
        (async () => {
            liff.ready.then(async() => {
              //ถ้ายังไม่ได้ login ให้ login
                if (!liff.isLoggedIn()) {
                    liff.login();
                } else {
                    let profile = await liff.getProfile()
                    $("#img-upload").hide();
                    // let url = `${scriptURL}?opt=getname&uid=${profile.userId}`;
                    // fetch(url)
                    //     .then(response => response.json())
                    //     .then(response => {
                    //         setName(response);
                    //     });
                }
            });
            //firebaseInit();
            await liff.init({ liffId: liffId });
        })();
        // function setDropdown(data) {
        //     let dropdown = [...new Set(data.data)];
        //     dropdown.forEach((row, i) => {
        //         if (i == 0) {
        //             $("#position").append(
        //                 `<option value="" disabled="" selected="">list รายชื่อนักกีฬา</option>`
        //             );
        //         }
        //         $("#position").append(`<option value="${row}">${row}</option>`);
        //     });
        //     if (dropdown.length == 1) {
        //         $("#dropdown").val(dropdown[0]);
        //     }
        //     $('#')
        // }
       
       
      
    </script>
    <script>
    //สร้างไฟล์รูปภาพ
        let img_bill;
        let form = $("form")[0];
        $("#img_bill").on("change", () => {
            $("#img-upload").show();
            let file = $("#img_bill").prop("files")[0];
            if (file != undefined) {
                let fr = new FileReader();
                fr.readAsArrayBuffer(file);
                fr.onload = f => {
                    img_bill = JSON.stringify([...new Int8Array(f.target.result)]);
                };
            }
        });
        form.addEventListener("submit", e => {
            e.preventDefault();
            $("#btn_submit").html(
                `<span class="spinner-border spinner-border-lg" role="status" aria-hidden="true"></span>  ...กำลังบันทึก`
            );
		 $("#aleart").html(
                ` **อย่าปิดหน้านี้ จนกว่าจะบันทึกสำเร็จ**`
            );

            let formdata = new FormData(form);
            formdata.set("img_bill", img_bill);
            formdata.append("billName", $("#img_bill").prop("files")[0]?.name);
            formdata.append("billMimeType", $("#img_bill").prop("files")[0]?.type);
            console.log(...formdata);
            fetch(scriptURL, {
                method: "POST",
                body: formdata
            })
                .then(response => response.json())
                .then(response => {
                    $("#btn_submit").html("บันทึกข้อมูล");
                    if (response.result == "success") {
                        if (liff.isInClient()) {
                            liff
                                .sendMessages([
                                    {
                                        type: "flex",
                                        altText: "ส่งผลทายหวย",
                                        contents:
                                        // วาง Json ที่ copy จาก flex simulator ตรงนี้
 {
  "type": "bubble",
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "ส่งทายหวยเรียบร้อยแล้ว!",
        "weight": "bold",
        "color": "#1DB446",
        "size": "sm"
      },
      {
        "type": "text",
        "text": "ขอให้ท่านโชคดี",
        "weight": "bold",
        "size": "xxl",
        "margin": "md",
        "align": "center"
      },
      {
        "type": "separator",
        "margin": "xxl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "xxl",
        "spacing": "sm",
        "contents": [
          {
            "type": "image",
            "url": response.url.replace("&export=download",""),
            "size": "md"
          },
          {
            "type": "text",
            "text": "สินค้าที่ท่านชอบคือ:"+$("#productname").val(),
            "weight": "bold",
            "size": "sm",
            "margin": "md",
            "color": "#1DB446"
          },
          {
            "type": "separator",
            "margin": "xxl"
          },
          {
            "type": "box",
            "layout": "horizontal",
            "margin": "xxl",
            "contents": [
              {
                "type": "text",
                "text": "เลขที่1:",
                "size": "xl",
                "color": "#555555"
              },
              {
                "type": "text",
                "text": ""+$("#number1").val(),
                "size": "xl",
                "color": "#111111",
                "align": "center"
              }
            ]
          },
          {
            "type": "box",
            "layout": "horizontal",
            "contents": [
              {
                "type": "text",
                "text": "เลขที่2:",
                "size": "xl",
                "color": "#555555"
              },
              {
                "type": "text",
                "text": ""+$("#number2").val(),
                "size": "xl",
                "color": "#111111",
                "align": "center"
              }
            ]
          },
          {
            "type": "box",
            "layout": "horizontal",
            "contents": [
              {
                "type": "text",
                "text": "เลขที่3:",
                "size": "xl",
                "color": "#555555"
              },
              {
                "type": "text",
                "text": ""+$("#number3").val(),
                "size": "xl",
                "color": "#111111",
                "align": "center"
              }
            ]
          },
          {
            "type": "box",
            "layout": "horizontal",
            "contents": [
              {
                "type": "text",
                "text": "เลขที่4:",
                "size": "xl",
                "color": "#555555"
              },
              {
                "type": "text",
                "text": ""+$("#number4").val(),
                "size": "xl",
                "color": "#111111",
                "align": "center"
              }
            ]
          },
          {
            "type": "box",
            "layout": "horizontal",
            "contents": [
              {
                "type": "text",
                "text": "เลขที่5:",
                "size": "xl",
                "color": "#555555"
              },
              {
                "type": "text",
                "text": ""+$("#number5").val(),
                "size": "xl",
                "color": "#111111",
                "align": "center"
              }
            ]
          },
          {
            "type": "text",
            "text": "นี่คือเลขที่ท่านทาย โปรดเก็บไว้เป็นหลักฐาน",
            "weight": "bold",
            "size": "sm",
            "margin": "md",
            "color": "#ff3333"
          }
        ]
      },
      {
        "type": "separator",
        "margin": "xxl"
      },
      {
        "type": "box",
        "layout": "horizontal",
        "margin": "md",
        "contents": [
          {
            "type": "text",
            "text": "ผู้ส่ง : " + $("#name").val(),
            "size": "xs",
            "color": "#aaaaaa",
            "flex": 0
          },
          {
            "type": "text",
            "text": "เบอร์โทร:"+$("#tel").val(),
            "color": "#aaaaaa",
            "size": "xs",
            "align": "end"
          }
        ]
      }
    ]
  },
  "styles": {
    "footer": {
      "separator": true
    }
  }
}
//   {
//   "type": "bubble",
//   "body": {
//     "type": "box",
//     "layout": "vertical",
//     "contents": [
//       {
//         "type": "text",
//         "text": "ส่งสลิปสำเร็จ 333 IDPA 2/2021",
//         "weight": "bold",
//         "color": "#1DB446",
//         "size": "lg"
//       },
//       {
//         "type": "separator",
//         "margin": "xxl"
//       },
//       {
//         "type": "box",
//         "layout": "vertical",
//         "contents": [
//           {
//             "type": "text",
//             "text": "ผู้จัดงานได้รับสลิปการโอนเงินของท่านแล้ว",
//             "size": "sm",
//             "margin": "md",
//             "wrap": true
//           },
//           {
//             "type": "text",
//             "text": "รายชื่อนักกีฬาจะแจ้งให้ทราบ",
//             "size": "sm",
//             "wrap": true
//           },
//           {
//             "type": "text",
//             "text": ""+$("#lname").val(),
//             "size": "sm",
//             "wrap": true
//           }
//         ]
//       },
       
//       {
//         "type": "box",
//         "layout": "vertical",
//         "margin": "xxl",
//         "contents": [
//           {
//             "type": "image",
//             "url": response.url.replace("&export=download",""),
//             "size": "full"
//           },
//           {
//             "type": "separator"
//           },
//           {
//             "type": "text",
//             "text": "Shooter : " + $("#position").val(),
//             "color": "#aaaaaa"
//           }
//         ],
//         "spacing": "xxl"
//       }
//     ]
//   },
//   "styles": {
//     "footer": {
//       "separator": true
//     }
//   }
// }
                                        ///ปิด flex ตรงนี้
                                    }
                                ])
                          //sendMessage เข้าไลน์ แบบข้อความธรรมดา
//                           liff.sendMessages([
//                 {
//                   type: "text",
//                   text: ""+ $("#position").val()
//                 },
//                   {
//                   type: "text",
//                   text: ""+ $("#lname").val()
//                 },
//                 {
//                   type: "text",
//                   text: "" +response.url
//                 }
//               ])
                          
                          
                                .then(() => {
                                    console.log("message sent");
                                    liff.closeWindow();
                                })
                                .catch(err => {
                                    alert(err);
                                });
                        } else {
                            Swal.fire({
                                position: "center",
                                icon: "success",
                                title: "บันทึกเรียบร้อย",
                                showConfirmButton: true
                            });
                        }
                    } else {
                        Swal.fire({
                            position: "center",
                            icon: "error",
                            title: "มีข้อผิดพลาด",
                            text: response.error,
                            showConfirmButton: true
                        });
                    }
                });
        });
    </script>
    <script>
        $(document).ready(function () {
            $(document).on("change", ".btn-file :file", function () {
                var input = $(this),
                    label = input
                        .val()
                        .replace(/\\/g, "/")
                        .replace(/.*\//, "");
                input.trigger("fileselect", [label]);
            });

            $(".btn-file :file").on("fileselect", function (event, label) {
                var input = $(this)
                    .parents(".input-group")
                    .find(":text"),
                    log = label;

                if (input.length) {
                    input.val(log);
                } else {
                    if (log) alert(log);
                }
            });

            function readURL(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        $("#img-upload").attr("src", e.target.result);
                    };

                    reader.readAsDataURL(input.files[0]);
                }
            }

            $("#img_bill").change(function () {
                readURL(this);
            });
        });
    </script>
  
  <script>
var urlParams = new URLSearchParams(window.location.search);
  
for (let p of urlParams) { 
if (p[0] == "name") addvalue("position", p[1]) 
    console.log(p[0] + " : " + p[1]); 
}
  
function addvalue(name, val) {
    const element = document.getElementById(name).value = val;
}

</script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
</body>

</html>
  
 
